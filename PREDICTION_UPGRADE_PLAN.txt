for this apps predictor:

I need you to upgrade my cryptocurrency prediction module (betterpredictormodule.py) into a comprehensive event-driven predictive system with historical correlation analysis. Here's what I need:

## CORE TRANSFORMATION

Convert the existing technical analysis tool into a 3-layer system that:
1. **Stores historical event data** (Fed decisions, regulatory news, major crypto events)
2. **Correlates events with price movements** across multiple timeframes
3. **Predicts future price action** based on pattern matching with historical similar scenarios

## DATABASE SCHEMA (Use SQLite - Free)

Create these tables:

**events**
- id (primary key)
- event_date (timestamp)
- event_type (Fed_Cut, Fed_Hike, ETF_Decision, Halving, Exchange_Hack, Regulatory, etc.)
- description (text)
- severity (1-10 scale)
- expected_impact (bullish/bearish/neutral)

**technical_snapshots**
- snapshot_id (primary key)
- event_id (foreign key)
- token_symbol (text)
- timestamp (when snapshot taken)
- price (at event time)
- rsi_14, macd, ema_9, ema_21, ema_50, adx, bb_width, volume_ratio (all technical indicators)
- market_regime (Trending_Bull, Trending_Bear, Ranging, Volatile)
- confluence_score (number)
- dominant_bias (bullish/bearish/neutral)

**price_movements**
- movement_id (primary key)
- event_id (foreign key)
- token_symbol
- price_before_24h, price_before_12h, price_before_6h, price_before_1h
- price_at_event
- price_after_1h, price_after_6h, price_after_12h, price_after_24h, price_after_7d, price_after_30d
- pct_change_1h, pct_change_24h, pct_change_7d, pct_change_30d
- volume_spike (boolean)
- volatility_increase (percentage)

**sentiment_data**
- sentiment_id (primary key)
- event_id (foreign key)
- timestamp
- fear_greed_index (0-100)
- fear_greed_classification (Extreme Fear, Fear, Neutral, Greed, Extreme Greed)
- reddit_sentiment_score (-1 to 1)
- social_volume (mentions count)
- news_sentiment (positive/negative/neutral)

**correlation_patterns**
- pattern_id (primary key)
- event_type
- technical_conditions (JSON: what indicators looked like before)
- avg_price_response_1h, avg_price_response_24h, avg_price_response_7d
- success_rate (percentage)
- sample_size (how many historical matches)
- best_entry_timing (hours after event)
- typical_peak_time (hours after event)
- risk_factors (text: what conditions weaken pattern)

## KEY FEATURES TO IMPLEMENT

### 1. Historical Data Collection
```python
def collect_historical_event(event_date, event_type, description, severity, token_symbol="BTCUSDT"):
    """
    For a given historical event:
    - Fetch price data 7 days before and after using existing Binance/CoinGecko methods
    - Calculate technical indicators at event time using add_comprehensive_indicators()
    - Capture price movements at 1h, 6h, 24h, 7d, 30d intervals
    - Fetch Fear & Greed index for that date (https://api.alternative.me/fng/?limit=0)
    - Store everything in database
    """
```

### 2. Pattern Matching Engine
```python
def find_similar_historical_scenarios(current_technical_state, upcoming_event_type, lookback_days=1825):
    """
    Query database for historical events where:
    - Event type matches (e.g., both Fed rate cuts)
    - Technical indicators were similar (RSI ¬±10, MACD direction same, EMA alignment similar)
    - Market regime was comparable
    - Return: List of matched events with their subsequent price movements
    """
```

### 3. Prediction Generator
```python
def generate_prediction(token_symbol, upcoming_event_type, current_technical_state):
    """
    Based on pattern matching:
    - Find 5-10 most similar historical scenarios
    - Calculate average/median price movements from those scenarios
    - Determine confidence score (based on consistency and sample size)
    - Output prediction like:
      "Based on 8 similar Fed rate cuts where RSI was 35-45 and price was above 21 EMA:
       - 75% probability of +8-12% move within 48 hours
       - Average peak time: 36 hours post-event
       - Historical range: +6% to +18%
       - Success rate: 87.5% (7/8 were profitable)"
    """
```

### 4. Event Monitor (Real-Time)
```python
def monitor_upcoming_events():
    """
    - Check FRED API for scheduled Fed meetings
    - Scrape economic calendars (Investing.com, ForexFactory)
    - When event detected within 48 hours:
      * Capture current technical snapshot
      * Run pattern matching
      * Generate prediction
      * Send alert
    """
```

### 5. Free Data Integration

Add these free data sources:
```python
# Fear & Greed (add to existing code)
def fetch_fear_greed_history():
    url = "https://api.alternative.me/fng/?limit=0"
    # Returns entire history, free, no auth needed

# FRED API (Federal Reserve Economic Data)
def fetch_fed_interest_rates():
    # Use FRED API for historical rate data
    # API key is free from https://fred.stlouisfed.org/docs/api/

# Reddit Sentiment (optional, using PRAW - free)
def get_reddit_sentiment_for_date(keyword, target_date):
    # Use PRAW library to fetch Reddit posts around event date
    # Analyze with VADER sentiment (free Python library)
```

## INITIAL SEED DATA

Provide a starter dataset of 20-30 major events:
```python
HISTORICAL_EVENTS = [
    {"date": "2020-03-15", "type": "Fed_Emergency_Cut", "desc": "Emergency 1% rate cut", "severity": 10},
    {"date": "2021-11-10", "type": "Inflation_CPI", "desc": "CPI hits 6.2%", "severity": 8},
    {"date": "2022-03-16", "type": "Fed_Rate_Hike", "desc": "First hike cycle 0.25%", "severity": 9},
    {"date": "2024-01-10", "type": "ETF_Approval", "desc": "Bitcoin spot ETF approved", "severity": 10},
    # Add 20-30 major events from 2019-2024
]

def seed_database():
    """Auto-populate database with these events and fetch all historical data"""
```

## OUTPUT FORMAT

The enhanced predictor should output:
üéØ PREDICTION FOR BTC - Fed Rate Decision Tomorrow
üìä HISTORICAL ANALYSIS (8 similar scenarios found):
Event Type: Fed Rate Cut (0.25% - 0.5%)
Technical Conditions Match: 87% similarity
Average Price Response:

1 hour:  +2.3% (range: +1.1% to +4.2%)
24 hours: +11.2% (range: +6% to +18%)
7 days: +8.7% (range: +3% to +15%)

Typical Timeline:

Initial reaction: 15-30 minutes
Peak movement: 36-48 hours post-announcement
Consolidation: Day 3-5

üîç CURRENT VS HISTORICAL COMPARISON:
‚úÖ RSI (38) matches historical avg (41) - within range
‚úÖ Price above 21 EMA - Same as 7/8 successful cases
‚ö†Ô∏è  Volume 15% lower than typical pre-event average
‚úÖ Fear & Greed (32) similar to historical (28-35)
üí° PREDICTION (73% Confidence):
Most Likely Scenario: +8-12% within 48 hours
Best Case (25% probability): +15-18%
Worst Case (12% probability): -2-3% (if unexpected hawkish tone)
Optimal Entry: Current price or slight dip in next 12h
Suggested Exit: 36-48 hours post-event (historical peak time)
Stop Loss: -4% (below worst historical case)
üìã MOST SIMILAR HISTORICAL EVENT:
Jul 2023 Fed Cut (0.25%)

RSI pre-event: 38 (Current: 38) ‚úÖ
Price vs EMA: +3.1% (Current: +3.2%) ‚úÖ
Result: +14% in 42 hours

‚ö†Ô∏è  RISK FACTORS:

Lower volume suggests weaker follow-through potential
If Fed signals pause (not continuation), effect may reverse
Bitcoin dominance at 52% (historically 48-55% during cuts)

üìà CONFIDENCE BREAKDOWN:

Pattern Match Quality: 87/100
Sample Size: 8 events (good)
Consistency: 7/8 moved up (87.5%)
Technical Alignment: Strong
Sentiment Alignment: Moderate

Overall Confidence: 73%

## TECHNICAL REQUIREMENTS

- Keep all existing technical analysis functions (don't break current functionality)
- Use SQLite for database (free, no setup)
- All APIs must be FREE (Binance, CoinGecko, FRED, Alternative.me)
- Add command-line options:
  * `--analyze TOKEN TIMEFRAME` (existing functionality)
  * `--add-event DATE TYPE DESCRIPTION SEVERITY` (add historical event)
  * `--predict TOKEN EVENT_TYPE` (generate prediction for upcoming event)
  * `--seed-database` (populate with initial 30 events)
  * `--backtest EVENT_ID` (show what would have happened)

## DELIVERABLES

1. **Enhanced betterpredictormodule.py** with all new functionality
2. **database_setup.sql** - SQLite schema
3. **seed_events.py** - Script to populate initial 30 historical events
4. **README_PREDICTION.md** - Documentation on how to use new features

## CONSTRAINTS

- 100% FREE data sources only
- Must work offline after initial data collection
- Keep existing TradingAnalyzer class, extend it
- Add new EventCorrelationEngine class
- Use existing technical indicators (don't rewrite those)
- Maximum 2000 lines total (keep it manageable)

## EXAMPLE USAGE
```python
from betterpredictormodule import EnhancedPredictor

predictor = EnhancedPredictor()

# Seed database (one-time)
predictor.seed_historical_events()

# Add new event manually
predictor.add_event(
    date="2024-12-18",
    event_type="Fed_Rate_Cut", 
    description="0.25% cut",
    severity=8
)

# Generate prediction for upcoming event
prediction = predictor.predict(
    token="BTCUSDT",
    event_type="Fed_Rate_Cut",
    event_date="2025-01-29"  # Upcoming FOMC
)

# Backtest historical pattern
predictor.backtest_event(event_id=15)
```

Make this production-ready, well-documented, and easy to use. Focus on accuracy through historical pattern matching rather than complex ML models.